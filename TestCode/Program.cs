using Newtonsoft.Json.Linq;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace TestCode
{
    class Program
    {
        static void Main(string[] args)
        {


            var val = Newtonsoft.Json.JsonConvert.DeserializeObject<List<JObject>>(JsonFile.Text);

            IEnumerable<JObject> obj = Newtonsoft.Json.JsonConvert.DeserializeObject<IEnumerable<JObject>>(JsonFile.Text);
            var eventIDs = string.Empty;
            //Console.WriteLine(obj);
            IEnumerable<JObject> eventList = Newtonsoft.Json.JsonConvert.DeserializeObject<IEnumerable<JObject>>(JsonFile.Text);
            Console.WriteLine(eventList);
            var tepLis = eventList.OrderByDescending(x => x.SelectToken("ExecutionTimeStamp")).Take(10).Select(o => o.SelectToken("ID").Value<string>());
            Console.WriteLine(tepLis.Count());
            eventIDs = string.Join(", <br/>", tepLis);
            Console.WriteLine(eventIDs);

        }
    }

    public static class JsonFile
    {
        public static string Text = "[{\"ID\":\"d69ebc17-78a1-4bf6-9825-20f98c1d9b43\",\"Environment\":\"staging\",\"Status\":\"COMPLETED\",\"BHs\":[\"tenant:3144168\",\"http://core.rackspace.com/py/core/#/device/801856\"],\"PHs\":[\"source:rba_qe_persist\",\"event:pause_only\",\"rba_qe_persist:pause_only\"],\"ExecutionTimeStamp\":\"2019-08-22T00:01:56.761\",\"Metadata\":{\"EventStatus\":\"COMPLETED\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"StreamID\":\"ebbc9237-d1df-4a1e-834b-aa41ace2ee09\",\"StreamStatus\":\"NULL\",\"ActiveTicketNumber\":\"\",\"CORE:PROCESS TICKET\":\"\",\"Event Name\":\"pause_only\",\"EventStatus_1\":\"ENQUEUED_PREPROCESSING\",\"EventStatus_2\":\"PAUSED\",\"EventStatus_3\":\"PREPROCESSING\",\"EventStatus_4\":\"ENQUEUED_PROCESSING\",\"EventStatus_5\":\"PROCESSING\",\"EventStatus_6\":\"PAUSED\",\"EventStatus_7\":\"PROCESSING\",\"EventStatus_8\":\"COMPLETED\",\"ExpectedDequeueTime\":\"2019-08-22T00:01:56.761\",\"RNS:PROCESS THREAD\":\"\",\"RNSThreadID\":\"\",\"Source\":\"rba_qe_persist\",\"SystemType\":\"stage-b\",\"Tenant\":\"3144168\",\"TimeTaken\":\"5\",\"Ticket Number\":\"\"},\"Tenant\":\"3144168\",\"DeviceID\":\"801856\",\"ProcessStatus\":\"COMPLETED\",\"ProcessType\":\"v25\",\"EventAggregationID\":\"\",\"EventTicket\":\"\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"AricVersion\":\"v2.5\"},{\"ID\":\"a7dd1410-a80f-48c9-84c4-07627fd41d27\",\"Environment\":\"staging\",\"Status\":\"COMPLETED\",\"BHs\":[\"tenant:hybrid:3144168\",\"http://core.rackspace.com/py/core/#/device/801856\"],\"PHs\":[\"source:rba_qe_persist\",\"event:pause_only\",\"rba_qe_persist:pause_only\"],\"ExecutionTimeStamp\":\"2019-08-22T00:01:56.478\",\"Metadata\":{\"EventStatus\":\"COMPLETED\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"StreamID\":\"0e0691c0-f8d2-43fd-8a72-f6e65e528f6d\",\"StreamStatus\":\"NULL\",\"ActiveTicketNumber\":\"\",\"CORE:PROCESS TICKET\":\"\",\"Event Name\":\"pause_only\",\"EventStatus_1\":\"ACCEPTED\",\"EventStatus_2\":\"ENQUEUED_PREPROCESSING\",\"EventStatus_3\":\"PREPROCESSING\",\"EventStatus_4\":\"ENQUEUED_PROCESSING\",\"EventStatus_5\":\"PROCESSING\",\"EventStatus_6\":\"PAUSED\",\"EventStatus_7\":\"PROCESSING\",\"EventStatus_8\":\"COMPLETED\",\"RNS:PROCESS THREAD\":\"\",\"RNSThreadID\":\"\",\"Source\":\"rba_qe_persist\",\"SystemType\":\"stage-b\",\"Tenant\":\"hybrid:3144168\",\"TimeTaken\":\"5\",\"Ticket Number\":\"\"},\"Tenant\":\"hybrid:3144168\",\"DeviceID\":\"801856\",\"ProcessStatus\":\"COMPLETED\",\"ProcessType\":\"v25\",\"EventAggregationID\":\"\",\"EventTicket\":\"\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"AricVersion\":\"v2.5\"},{\"ID\":\"fc8fea57-71c7-4baa-aeb6-2b5c54ac3609\",\"Environment\":\"staging\",\"Status\":\"COMPLETED\",\"BHs\":[\"tenant:3144168\",\"http://core.rackspace.com/py/core/#/device/801856\"],\"PHs\":[\"source:rba_qe_persist\",\"event:pause_only\",\"rba_qe_persist:pause_only\"],\"ExecutionTimeStamp\":\"2019-08-22T00:01:56.205\",\"Metadata\":{\"EventStatus\":\"COMPLETED\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"StreamID\":\"ed600fe9-dd4d-4c1e-82dc-756b2dc1430e\",\"StreamStatus\":\"NULL\",\"ActiveTicketNumber\":\"\",\"CORE:PROCESS TICKET\":\"\",\"Event Name\":\"pause_only\",\"EventStatus_1\":\"ENQUEUED_PREPROCESSING\",\"EventStatus_2\":\"PAUSED\",\"EventStatus_3\":\"PREPROCESSING\",\"EventStatus_4\":\"ENQUEUED_PROCESSING\",\"EventStatus_5\":\"PROCESSING\",\"EventStatus_6\":\"PAUSED\",\"EventStatus_7\":\"PROCESSING\",\"EventStatus_8\":\"COMPLETED\",\"ExpectedDequeueTime\":\"2019-08-22T00:01:56.205\",\"RNS:PROCESS THREAD\":\"\",\"RNSThreadID\":\"\",\"Source\":\"rba_qe_persist\",\"SystemType\":\"stage-b\",\"Tenant\":\"3144168\",\"TimeTaken\":\"5\",\"Ticket Number\":\"\"},\"Tenant\":\"3144168\",\"DeviceID\":\"801856\",\"ProcessStatus\":\"COMPLETED\",\"ProcessType\":\"v25\",\"EventAggregationID\":\"\",\"EventTicket\":\"\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"AricVersion\":\"v2.5\"},{\"ID\":\"9c84d9c1-48f4-4662-838b-34532d479df2\",\"Environment\":\"staging\",\"Status\":\"COMPLETED\",\"BHs\":[\"tenant:3144168\",\"http://core.rackspace.com/py/core/#/device/801856\"],\"PHs\":[\"source:rba_qe_persist\",\"event:pause_only\",\"rba_qe_persist:pause_only\"],\"ExecutionTimeStamp\":\"2019-08-22T00:01:55.33\",\"Metadata\":{\"EventStatus\":\"COMPLETED\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"StreamID\":\"41f324b3-a3ec-4581-a711-3929eda37a34\",\"StreamStatus\":\"NULL\",\"ActiveTicketNumber\":\"\",\"CORE:PROCESS TICKET\":\"\",\"Event Name\":\"pause_only\",\"EventStatus_1\":\"ENQUEUED_PREPROCESSING\",\"EventStatus_2\":\"PAUSED\",\"EventStatus_3\":\"PREPROCESSING\",\"EventStatus_4\":\"ENQUEUED_PROCESSING\",\"EventStatus_5\":\"PROCESSING\",\"EventStatus_6\":\"PAUSED\",\"EventStatus_7\":\"PROCESSING\",\"EventStatus_8\":\"COMPLETED\",\"ExpectedDequeueTime\":\"2019-08-22T00:01:55.33\",\"RNS:PROCESS THREAD\":\"\",\"RNSThreadID\":\"\",\"Source\":\"rba_qe_persist\",\"SystemType\":\"stage-b\",\"Tenant\":\"3144168\",\"TimeTaken\":\"5\",\"Ticket Number\":\"\"},\"Tenant\":\"3144168\",\"DeviceID\":\"801856\",\"ProcessStatus\":\"COMPLETED\",\"ProcessType\":\"v25\",\"EventAggregationID\":\"\",\"EventTicket\":\"\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"AricVersion\":\"v2.5\"},{\"ID\":\"7117d445-0bcf-4564-b9c0-2f2bc30e10cc\",\"Environment\":\"staging\",\"Status\":\"COMPLETED\",\"BHs\":[\"tenant:3144168\",\"http://core.rackspace.com/py/core/#/device/801856\"],\"PHs\":[\"source:rba_qe_persist\",\"event:pause_only\",\"rba_qe_persist:pause_only\"],\"ExecutionTimeStamp\":\"2019-08-21T23:59:39.126\",\"Metadata\":{\"EventStatus\":\"COMPLETED\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"StreamID\":\"c1927829-0834-4a09-b9ae-6812a4e71f93\",\"StreamStatus\":\"NULL\",\"ActiveTicketNumber\":\"\",\"CORE:PROCESS TICKET\":\"\",\"Event Name\":\"pause_only\",\"EventStatus_1\":\"ENQUEUED_PREPROCESSING\",\"EventStatus_2\":\"PAUSED\",\"EventStatus_3\":\"PREPROCESSING\",\"EventStatus_4\":\"ENQUEUED_PROCESSING\",\"EventStatus_5\":\"PROCESSING\",\"EventStatus_6\":\"PAUSED\",\"EventStatus_7\":\"PROCESSING\",\"EventStatus_8\":\"COMPLETED\",\"ExpectedDequeueTime\":\"2019-08-21T23:59:39.126\",\"RNS:PROCESS THREAD\":\"\",\"RNSThreadID\":\"\",\"Source\":\"rba_qe_persist\",\"SystemType\":\"stage-b\",\"Tenant\":\"3144168\",\"TimeTaken\":\"5\",\"Ticket Number\":\"\"},\"Tenant\":\"3144168\",\"DeviceID\":\"801856\",\"ProcessStatus\":\"COMPLETED\",\"ProcessType\":\"v25\",\"EventAggregationID\":\"\",\"EventTicket\":\"\",\"ProcessURN\":\"rba_qe_persist:pause_only\",\"SensorID\":\"\",\"AricVersion\":\"v2.5\"}]";
    }
}
